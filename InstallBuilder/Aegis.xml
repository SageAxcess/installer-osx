<project>
    <shortName>Aegis</shortName>
    <fullName>Aegis Workstation Agent</fullName>
    <version>2.4.1</version>
    <componentList>
        <component>
            <name>default</name>
            <description>Default Component</description>
            <canBeEdited>1</canBeEdited>
            <selected>1</selected>
            <show>1</show>
            <folderList>
                <folder>
                    <description>Program Files</description>
                    <destination>${installdir}</destination>
                    <name>programfiles</name>
                    <platforms>all</platforms>
                    <shortcutList>
                        <shortcut>
                            <comment>Uninstall</comment>
                            <exec>${installdir}/${uninstallerName}</exec>
                            <icon></icon>
                            <name>Uninstall ${product_fullname}</name>
                            <path>${installdir}</path>
                            <platforms>all</platforms>
                            <runAsAdmin>0</runAsAdmin>
                            <runInTerminal>0</runInTerminal>
                            <windowsExec>${installdir}/${uninstallerName}.exe</windowsExec>
                            <windowsExecArgs></windowsExecArgs>
                            <windowsIcon></windowsIcon>
                            <windowsPath>${installdir}</windowsPath>
                        </shortcut>
                    </shortcutList>
                </folder>
                <folder>
                    <description>Program Files</description>
                    <destination>${installdir}</destination>
                    <name>programfileslinux</name>
                    <platforms>linux</platforms>
                </folder>
                <folder>
                    <description>Program Files</description>
                    <destination>${installdir}</destination>
                    <name>programfileswindows</name>
                    <platforms>windows</platforms>
                    <distributionFileList>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/aegis.conf</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/aegis.exe</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/curllib.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/libbind.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/libeay32.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/libgcc_s_sjlj-1.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/libgmp-10.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/libgnutls-30.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/libhogweed-4-2.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/libmicrohttpd.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/libnettle-6-2.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/libp11-kit-0.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/libsasl.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/libsodium.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/libzmq.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/msvcp100.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/msvcp100d.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/msvcr100.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/msvcr100d.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/openldap.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/Packet.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/PlibC-0.1.5.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/pthread.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/ssleay32.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/unins000.dat</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/unins000.exe</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/wpcap.dll</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/zlib1.dll</origin>
                        </distributionFile>
                        <distributionDirectory>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/browser</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/deploy</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/extensions</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/logs</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>files-win/Program Files/ChangeDynamix/AEGIS/scripts</origin>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>Program Files</description>
                    <destination>${installdir}</destination>
                    <name>programfilesosx</name>
                    <platforms>osx</platforms>
                    <distributionFileList>
                        <distributionFile>
                            <origin>files-mac/Safari Extension/AEGIS.safariextz</origin>
                        </distributionFile>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>/usr/local/</description>
                    <destination>/usr/local/</destination>
                    <name>usrlocal</name>
                    <platforms>osx</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>files-mac/usr.local/bin</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>files-mac/usr.local/Cellar</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>files-mac/usr.local/etc</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>files-mac/usr.local/include</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>files-mac/usr.local/lib</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>files-mac/usr.local/opt</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>files-mac/usr.local/share</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>files-mac/usr.local/var</origin>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>/Library/LaunchDaemons/</description>
                    <destination>/Library/LaunchDaemons/</destination>
                    <name>LibraryLaunchDaemons</name>
                    <platforms>osx</platforms>
                    <distributionFileList>
                        <distributionFile>
                            <origin>files-mac/Library.LaunchDaemons/aegis.plist</origin>
                        </distributionFile>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>/Library/Application Support/Google/Chrome/External Extensions/</description>
                    <destination>/Library/Application Support/Google/Chrome/External Extensions/</destination>
                    <name>GoogleChromeExtension</name>
                    <platforms>osx</platforms>
                    <distributionFileList>
                        <distributionFile>
                            <origin>files-mac/Google Chrome Extension/ljggkhkdbndekocjhnhnebkilnmaeopj.json</origin>
                        </distributionFile>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>ProgramData</description>
                    <destination>C:/ProgramData</destination>
                    <name>ProgramData</name>
                    <platforms>windows</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>files-win/ProgramData/Aegis</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>files-win/ProgramData/AEGIS Extension</origin>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>
                <folder>
                    <description>Program Files</description>
                    <destination>C:/Program Files/</destination>
                    <name>CProgramFiles</name>
                    <platforms>windows</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>files-win/Program Files/Win10Pcap</origin>
                        </distributionDirectory>
                    </distributionFileList>
                </folder>
            </folderList>
            <startMenuShortcutList>
                <startMenuShortcut>
                    <comment>Uninstall ${product_fullname}</comment>
                    <name>Uninstall ${product_fullname}</name>
                    <runAsAdmin>0</runAsAdmin>
                    <runInTerminal>0</runInTerminal>
                    <windowsExec>${installdir}/${uninstallerName}.exe</windowsExec>
                    <windowsExecArgs></windowsExecArgs>
                    <windowsIcon></windowsIcon>
                    <windowsPath>${installdir}/</windowsPath>
                </startMenuShortcut>
            </startMenuShortcutList>
        </component>
    </componentList>
    <postInstallationActionList>
        <writeFile>
            <encoding>utf-8</encoding>
            <explanation>Update Aegis configuration file</explanation>
            <path>/usr/local/Cellar/aegis/2.4.1/conf/aegis.conf</path>
            <text>############################
# Aegis config file
############################

# Aegis settings

# Specify interface name to listen on. For Windows - it will be something like \Device\NPF_{F53438F5-79C7-4A78-8254-B10D3CA50225}
# For Linux/OSX - en0 or eth0
# Use aegis --print-interfaces to see all available interfaces.
# Value of "*" means listen on all interfaces.
listen.interface=${ListenOn}
# Default policy to use. Cannot be applied without service restart. Defines scripts/features to be loaded.
default.policy=local

# Aggregator settings

# Main aggregator address. You can omit tcp:// and :port if it is default (5555)
zmq.server=tcp://${AggregatorHost}:${AggregatorPort}
# Comma-separated list of secondary aggregators. You can omit tcp:// and :port if it is default (5555)
#zmq.server.secondary=localhost,tcp://192.168.1.15:5556,tcp://data.sageaxcess.com
# Aggregator public key
zmq.public_key=${PublicKey}

# Local agent settings

# Plain http port
agent.port=${ExtensionPort}
# Https port
agent.port.ssl=8112

# Updater settings

# Automatic updates enabled/disabled flag. If enabled, updater will periodically check if there's a new version available
updates.enabled=${EnableAutomaticUpdates}
# Interval for automatic updates check, in minutes
updates.interval=60
# Remote control enabled/disabled flag. If enabled, plugin will query aggregator for a list of available commands each 1 minute.
remote.control=true
# Base url for remote updates
updater.url=http://build.sageaxcess.com

# Remote input
#remote.input.interface=en0
#remote.input.key_file=
#remote.input.hostname=192.168.1.1
#remote.input.username=root
#remote.input.exec=tcpdump

# usage limits

# Process priority. 0 = normal, -20 = highest, 19 = lowest. Use any values in between
process.priority=0
# Maximum disk usage, percent. Will be applied if it's lower than value in Mb.
disk.usage.relative=10
# Maximum disk usage, in Mb. Will be applied if it's lower than value in %
disk.usage.absolute=500</text>
            <ruleList>
                <platformTest>
                    <type>osx</type>
                </platformTest>
            </ruleList>
        </writeFile>
        <writeFile>
            <explanation>Update Aegis configuration file</explanation>
            <path>${installdir}/aegis.conf</path>
            <text>############################
# Aegis config file
############################

# Aegis settings

# Specify interface name to listen on. For Windows - it will be something like \Device\NPF_{F53438F5-79C7-4A78-8254-B10D3CA50225}
# For Linux/OSX - en0 or eth0
# Use aegis --print-interfaces to see all available interfaces.
# Value of "*" means listen on all interfaces.
listen.interface=${ListenOn}
# Default policy to use. Cannot be applied without service restart. Defines scripts/features to be loaded.
default.policy=local

# Aggregator settings

# Main aggregator address. You can omit tcp:// and :port if it is default (5555)
zmq.server=tcp://${AggregatorHost}:${AggregatorPort}
# Comma-separated list of secondary aggregators. You can omit tcp:// and :port if it is default (5555)
#zmq.server.secondary=localhost,tcp://192.168.1.15:5556,tcp://data.sageaxcess.com
# Aggregator public key
zmq.public_key=${PublicKey}

# Local agent settings

# Plain http port
agent.port=${ExtensionPort}
# Https port
agent.port.ssl=8112

# Updater settings

# Automatic updates enabled/disabled flag. If enabled, updater will periodically check if there's a new version available
updates.enabled=${EnableAutomaticUpdates}
# Interval for automatic updates check, in minutes
updates.interval=60
# Remote control enabled/disabled flag. If enabled, plugin will query aggregator for a list of available commands each 1 minute.
remote.control=true
# Base url for remote updates
updater.url=http://build.sageaxcess.com

# Remote input
#remote.input.interface=en0
#remote.input.key_file=
#remote.input.hostname=192.168.1.1
#remote.input.username=root
#remote.input.exec=tcpdump

# usage limits

# Process priority. 0 = normal, -20 = highest, 19 = lowest. Use any values in between
process.priority=0
# Maximum disk usage, percent. Will be applied if it's lower than value in Mb.
disk.usage.relative=10
# Maximum disk usage, in Mb. Will be applied if it's lower than value in %
disk.usage.absolute=500</text>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </writeFile>
        <runProgram>
            <explanation>Install Safari Extension</explanation>
            <program>open</program>
            <programArguments>-a Safari ${installdir}/AEGIS.safariextz</programArguments>
            <ruleList>
                <platformTest>
                    <type>osx</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <explanation>Add Aegis Extension to Google Chrome x32</explanation>
            <program>reg</program>
            <programArguments>add HKEY_LOCAL_MACHINE\Software\Google\Chrome\Extensions\ljggkhkdbndekocjhnhnebkilnmaeopj /v update_url /d https://clients2.google.com/service/update2/crx /f</programArguments>
            <ruleList>
                <platformTest>
                    <type>windows-x86</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <explanation>Add Aegis Extension to Google Chrome x64</explanation>
            <program>reg</program>
            <programArguments>add HKEY_LOCAL_MACHINE\Software\Wow6432Node\Google\Chrome\Extensions\ljggkhkdbndekocjhnhnebkilnmaeopj /v update_url /d https://clients2.google.com/service/update2/crx /f</programArguments>
            <ruleList>
                <platformTest>
                    <type>windows-x64</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <program>sc</program>
            <programArguments>create Aegis displayname= "AEGIS service" binPath= "${installdir}\aegis.exe" start= auto</programArguments>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <program>sc</program>
            <programArguments>description Aegis "Collects and analyzes network packets, transmits data to the cloud"</programArguments>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <program>sc</program>
            <programArguments>failure Aegis reset= 86400 actions= restart/1000</programArguments>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <program>sc</program>
            <programArguments>start Aegis</programArguments>
            <ruleList>
                <platformTest>
                    <type>windows</type>
                </platformTest>
            </ruleList>
        </runProgram>
    </postInstallationActionList>
    <preUninstallationActionList>
        <deleteWindowsService>
            <displayName></displayName>
            <serviceName>Aegis</serviceName>
        </deleteWindowsService>
    </preUninstallationActionList>
    <postUninstallationActionList>
        <runProgram>
            <program>rm</program>
            <programArguments>~/Library/Safari/Extensions/AEGIS.safariextz</programArguments>
            <ruleList>
                <platformTest>
                    <type>osx</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <program>reg</program>
            <programArguments>delete HKEY_LOCAL_MACHINE\Software\Google\Chrome\Extensions\ljggkhkdbndekocjhnhnebkilnmaeopj /f</programArguments>
            <ruleList>
                <platformTest>
                    <type>windows-x86</type>
                </platformTest>
            </ruleList>
        </runProgram>
        <runProgram>
            <program>reg</program>
            <programArguments>delete HKEY_LOCAL_MACHINE\Software\Wow6432Node\Google\Chrome\Extensions\ljggkhkdbndekocjhnhnebkilnmaeopj /f</programArguments>
            <ruleList>
                <platformTest>
                    <type>windows-x64</type>
                </platformTest>
            </ruleList>
        </runProgram>
    </postUninstallationActionList>
    <disableSplashScreen>1</disableSplashScreen>
    <enableRollback>1</enableRollback>
    <enableTimestamp>1</enableTimestamp>
    <height>420</height>
    <requireInstallationByRootUser>1</requireInstallationByRootUser>
    <saveRelativePaths>1</saveRelativePaths>
    <vendor>Change Dynamix, Inc.</vendor>
    <parameterList>
        <parameterGroup>
            <name>Advanced</name>
            <explanation></explanation>
            <value></value>
            <default></default>
            <parameterList>
                <stringParameter>
                    <name>ListenOn</name>
                    <description>Listen on:</description>
                    <explanation>Network Interface</explanation>
                    <value></value>
                    <default>*</default>
                    <allowEmptyValue>0</allowEmptyValue>
                    <width>40</width>
                </stringParameter>
                <booleanParameter>
                    <name>EnableAutomaticUpdates</name>
                    <description>Enable automatic updates</description>
                    <explanation></explanation>
                    <value>0</value>
                    <default></default>
                    <displayStyle>checkbox-left</displayStyle>
                </booleanParameter>
                <parameterGroup>
                    <name>AggregatorSettings</name>
                    <explanation>Aggregator settings</explanation>
                    <value></value>
                    <default></default>
                </parameterGroup>
                <stringParameter>
                    <name>AggregatorHost</name>
                    <description>Aggregator host:</description>
                    <explanation></explanation>
                    <value></value>
                    <default>localhost</default>
                    <allowEmptyValue>0</allowEmptyValue>
                    <width>40</width>
                </stringParameter>
                <stringParameter>
                    <name>AggregatorPort</name>
                    <description>Aggregator port:</description>
                    <explanation></explanation>
                    <value></value>
                    <default>5555</default>
                    <allowEmptyValue>0</allowEmptyValue>
                    <width>10</width>
                </stringParameter>
                <stringParameter>
                    <name>PublicKey</name>
                    <description>Public key:</description>
                    <explanation></explanation>
                    <value></value>
                    <default>5A5832576F434D2D57367D667148464865326E3C4B74586B733C574C7A624E6355642D5239282E7200</default>
                    <allowEmptyValue>0</allowEmptyValue>
                    <width>40</width>
                </stringParameter>
                <stringParameter>
                    <name>ExtensionPort</name>
                    <description>Extension port:</description>
                    <explanation>Local Agent settings</explanation>
                    <value></value>
                    <default>8111</default>
                    <allowEmptyValue>0</allowEmptyValue>
                    <width>10</width>
                </stringParameter>
            </parameterList>
        </parameterGroup>
        <directoryParameter>
            <name>installdir</name>
            <description>Installer.Parameter.installdir.description</description>
            <explanation>Installer.Parameter.installdir.explanation</explanation>
            <value></value>
            <default>${platform_install_prefix}/ChangeDynamix/AEGIS</default>
            <allowEmptyValue>0</allowEmptyValue>
            <ask>yes</ask>
            <cliOptionName>prefix</cliOptionName>
            <mustBeWritable>yes</mustBeWritable>
            <mustExist>0</mustExist>
            <width>50</width>
        </directoryParameter>
    </parameterList>
</project>

